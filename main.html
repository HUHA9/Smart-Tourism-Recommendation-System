<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Travel Recommendation System</title>
<style>
  /* ===== å…¨å±€é‡ç½® & å­—ä½“ ===== */
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
  html,body{height:100%;}
  
  /* èƒŒæ™¯å›¾ï¼ˆæ—…æ¸¸é£ï¼šè“å¤©/æµ·æ»©/å±±æ™¯ï¼‰ */
  body{
    background: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
    background-size: cover;
    color:#333;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding-top:70px; /* ä¸ºå›ºå®š header ç•™å‡ºç©ºé—´ï¼Œé¿å…å†…å®¹è¢«é®æŒ¡ */
  }
  
  /* é¡¶éƒ¨å¯¼èˆªï¼ˆé€æ˜ -> æ»šåŠ¨å˜è‰²ï¼‰ */
  header{
    position:fixed; top:0; left:0; width:100%;
    display:flex; justify-content:space-between; align-items:center;
    padding:14px 28px; z-index:1100;
    transition:all .35s ease;
    background:transparent;
  }
  header.scrolled{
    background: rgba(30,144,255,0.92);
    box-shadow:0 6px 24px rgba(0,0,0,0.18);
  }
  .logo{font-size:22px;font-weight:700;color:#fff;text-shadow:0 2px 6px rgba(0,0,0,0.25);}
  .user-info{display:flex;align-items:center;gap:10px;}
  .user-info span{color:#fff;font-weight:500;}
  
  /* æŒ‰é’®ï¼ˆåŠé€æ˜ç™½ + hover å˜è“ï¼‰ */
  .logout-btn,.history-btn,.mytrip-btn{
    background: rgba(255,255,255,0.95);
    color:#1e90ff;
    border:none;
    padding:7px 12px;border-radius:18px;cursor:pointer;font-weight:700;
    transition:all .22s ease;
  }
  .logout-btn:hover,.history-btn:hover,.mytrip-btn:hover{
    background:#1e90ff;color:#fff;transform:translateY(-2px);
  }
  /* like æŒ‰é’®ï¼ˆåŠé€æ˜ç™½ + hover å˜è“ï¼‰ */
  .liked-btn {
  background: rgba(255,255,255,0.95);
  color: #1e90ff;   
  border: none;
  padding: 7px 12px;
  border-radius: 18px;
  cursor: pointer;
  font-weight: 700;
  transition: all .22s ease;
}

.liked-btn:hover {
  background: #1e90ff;
  color: #fff;
  transform: translateY(-2px);
}

  /* heroï¼ˆé¦–é¡µå¤§èƒŒæ™¯ + æ ‡é¢˜ï¼‰ */
  .hero{
    height:50vh; display:flex; align-items:center; justify-content:center; text-align:center; position: relative;
  overflow: hidden;
    color:#fff; text-shadow:0 6px 18px rgba(0,0,0,0.45);
    margin-bottom:36px; padding:12px;
  }
  .hero h1{font-size:44px; font-weight:800; letter-spacing:0.6px; margin-bottom:8px;}
  .hero p{font-size:16px; opacity:0.95; margin-top:6px;}
  
  .hero-content {
  opacity: 0;
  transform: translateY(30px);
  animation: heroFadeUp 1.2s ease forwards;
  animation-delay: 0.3s;
}

@keyframes heroFadeUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

  /* ä¸»å®¹å™¨ï¼šç™½è‰²åŠé€æ˜å¡ç‰‡ç»ç’ƒé£ */
  .main-container{max-width:1200px;margin:0 auto 60px;padding:0 20px;display:flex;gap:30px;flex-wrap:wrap;}
  .left-section{flex:1;min-width:320px;}
  .right-section{flex:1;min-width:320px;}
  
  .plan-section,.recommendations,.right-section{
    background: rgba(255,255,255,0.95);
    border-radius:14px; padding:22px; box-shadow:0 8px 28px rgba(6,30,80,0.12);
    backdrop-filter: blur(6px);
  }
  
  /* æ ‡é¢˜æ ·å¼ */
  h2{color:#1e90ff;margin-bottom:12px;border-bottom:2px solid rgba(30,144,255,0.08);padding-bottom:8px;}
  
  /* è¡¨å•è¾“å…¥ */
  .form-group{margin-bottom:14px;}
  label{display:block;margin-bottom:8px;color:#444;font-weight:600;}
  input,select,textarea{
    width:100%;padding:10px;border:1px solid #e3e8ef;border-radius:8px;font-size:15px;
  }
  input:focus,select:focus,textarea:focus{outline:none;border-color:#1e90ff;box-shadow:0 4px 14px rgba(30,144,255,0.08);}
  
  /* æäº¤æŒ‰é’® */
  .submit-btn{
    background:#1e90ff;color:#fff;border:none;padding:12px;border-radius:10px;width:100%;font-weight:800;cursor:pointer;
  }
  .submit-btn:hover{background:#187bcd;transform:translateY(-2px);}
  
  /* ç›®çš„åœ°ç½‘æ ¼ï¼ˆå¡ç‰‡é—´è·æ›´å¤§ã€å¡ç‰‡æ›´é«˜ï¼‰ */
  .destinations-grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 24px;
  margin-top: 20px;
}

.destination-card {
  width: 300px;   /* å›ºå®šå®½åº¦ */
  height: 360px;  /* ç¨å¾®æ‹‰é•¿ */
  flex-grow: 1;
  background: rgba(255,255,255,0.95);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 8px 18px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}
/* ===== Scroll Animation: initial state ===== */
.destination-card {
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}

/* ===== Scroll Animation: when visible ===== */
.destination-card.show {
  opacity: 1;
  transform: translateY(0);
}

.destination-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 12px 30px rgba(30,144,255,0.2);
}

.destination-card {
  position: relative;
  overflow: hidden;
}

/* Hover æç¤ºå±‚ */
.destination-overlay {
  position: absolute;
  inset: 0;
  background: rgba(30, 144, 255, 0.75);
  color: #fff;
  font-size: 18px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;

  opacity: 0;
  transform: translateY(20px);
  transition: all 0.3s ease;
}

/* hover æ—¶å‡ºç° */
.destination-card:hover .destination-overlay {
  opacity: 1;
  transform: translateY(0);
}

  .destination-img{height:220px;background-size:cover;background-position:center;flex-shrink:0;}
  .destination-info{padding:14px; display:flex; flex-direction:column; justify-content:space-between; gap:8px;}
  .destination-name{font-weight:800;color:#1e90ff;font-size:18px;margin-bottom:6px;}
  .destination-desc{color:#556;font-size:14px;}
  
  /* æ¨èå¡ç‰‡ï¼ˆç¨å¤§ï¼‰ */
  .rec-card{display:flex;gap:16px;align-items:flex-start;padding:14px;border-radius:12px;margin-bottom:14px;
    background:rgba(255,255,255,0.98);box-shadow:0 6px 18px rgba(8,20,60,0.06);border:1px solid rgba(30,144,255,0.04);}
  .rec-img{width:180px;height:140px;background-size:cover;background-position:center;border-radius:10px;flex-shrink:0;}
  .rec-content{flex:1;}
  .rec-title{font-weight:700;color:#1e90ff;margin-bottom:6px;}
  .rec-details{color:#556;font-size:14px;margin-bottom:8px;}
  .rec-price{color:#e74c3c;font-weight:800;}
  
  /* æ¨¡æ€æ¡† */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.55);z-index:2200;}
  .modal-content{background:#fff;border-radius:12px;padding:20px;max-width:900px;width:92%;max-height:82vh;overflow:auto;box-shadow:0 20px 60px rgba(5,20,50,0.28);}
  
  /* footer */
  /* ====== FOOTER (DARKER BLUE TRANSPARENT BOX) ====== */
footer {
  background: rgba(20, 80, 160, 0.88); /* æ›´æ·±çš„è“è‰²ï¼Œæ›´æŸ”å’Œ */
  color: #f0f8ff;
  padding: 40px 30px 20px;
  border-radius: 20px 20px 0 0;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.25);
  margin-top: 60px;
}

.footer-container {
  max-width: 1100px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  flex-wrap: wrap;
  gap: 30px;
}

/* å·¦ä¾§ï¼šç½‘ç«™åç§° + tagline */
.footer-left h2 {
  font-size: 26px;
  font-weight: 800;
  color: #ffffff;              /* æ”¹æˆçº¯ç™½ */
  text-shadow: 0 2px 6px rgba(0,0,0,0.3); /* å¢åŠ é˜´å½±ï¼Œæ¸…æ™°å¯è§ */
  margin-bottom: 8px;
}

.footer-left .tagline {
  font-size: 15px;
  color: #dce8f8;              /* æ¯”èƒŒæ™¯äº®ä¸€ç‚¹çš„æµ…è“ç° */
  letter-spacing: 0.5px;
}

/* ä¸­é—´åˆ†éš”çº¿ */
.footer-divider {
  width: 2px;
  height: 80px;
  background: rgba(255,255,255,0.25);
}

/* å³ä¾§ï¼šè”ç³»æ–¹å¼ä¸ç¤¾äº¤ */
.footer-right {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 10px;
}

.footer-right .contact-info p {
  margin: 4px 0;
  font-size: 15px;
  color: #f1f6ff;              /* æ¯”çº¯ç™½ç¨æ·¡ä¸€ç‚¹ */
}

.footer-social {
  display: flex;
  flex-direction: row;
  gap: 18px;
  font-size: 28px;
  margin-top: 8px;
}

.footer-social a {
  color: #ffffff;
  text-decoration: none;
  transition: transform 0.3s, color 0.3s;
}

.footer-social a:hover {
  transform: scale(1.25);
  color: #aee0ff;              /* hover æ—¶å˜æµ…è“ */
}

.footer-bottom {
  text-align: center;
  margin-top: 25px;
  font-size: 13px;
  color: #eaf2ff;
  opacity: 0.9;
  border-top: 1px solid rgba(255,255,255,0.25);
  padding-top: 15px;
}

/* å“åº”å¼ */
@media (max-width: 700px) {
  .footer-container {
    flex-direction: column;
    align-items: center;
    text-align: center;
  }
  .footer-divider {
    display: none;
  }
  .footer-right {
    align-items: center;
  }
}

  /* å“åº”å¼ */
  @media(max-width:900px){
    .hero h1{font-size:32px}
    .main-container{flex-direction:column;padding:12px}
    .destination-card{height:auto}
    .rec-card{flex-direction:column}
    .rec-img{width:100%;height:160px}
  }
  .destinations-subtitle {
  margin-top: 6px;
  margin-bottom: 18px;
  font-size: 14px;
  color: #6b7280; /* é«˜çº§ç° */
  font-style: italic;
}
/* ===== Slim light-blue horizontal strip (background only) ===== */
.destinations-header {
  width: 100vw;
  margin-left: calc(-50vw + 50%);

  padding: 5px 40px;
  margin-bottom: 32px;

  background: linear-gradient(
    to right,
    rgba(30, 144, 255, 0.08),
    rgba(30, 144, 255, 0.18),
    rgba(30, 144, 255, 0.08)
  );

  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}



  </style>
  
</head>
<body>
      
<header>
<div class="logo">GoTrip-Travel Recommender</div>
<div class="user-info">
<span>Welcome, <span id="displayUsername"></span></span>
<button class="history-btn" id="historyBtn">My Travel History</button>
<button class="mytrip-btn" id="mytripBtn">My Trip</button>
<button class="liked-btn" id="likedBtn">â¤ï¸ Liked</button>
<button class="logout-btn" id="logoutBtn">Logout</button>

</div>
</header>
<!-- HERO: å…¨å±/å¤§èƒŒæ™¯æ ‡é¢˜åŒºåŸŸ -->
<section class="hero">
  <div class="hero-content">
    <h1>Discover Your Next Adventure</h1>
    <p>Find curated itineraries, attractions and travel plans â€” tailored for you.</p>
  </div>
</section>



<div class="main-container">

</div>
<div class="destinations-section">

  <div class="destinations-header">
    <h2 class="destinations-title">Popular Destinations</h2>
    <p class="destinations-subtitle">
      Click a city to view attractions and generate optimized itineraries
    </p>
  </div>

  <div class="destinations-grid" id="destinationsGrid">
    <!-- Destination cards -->
  </div>

</div>


</div>

<div class="modal" id="destinationModal">
<div class="modal-content">
<span class="close-btn" id="closeModalBtn">&times;</span>
<div class="destination-details" id="destinationDetails">
<!-- Destination details will be generated here -->
</div>
</div>
</div>

<div class="modal" id="historyModal">
<div class="modal-content">
<span class="close-btn" id="closeHistoryModalBtn">&times;</span>
<h2>My Travel History</h2>
<div id="historyList">
<!-- Travel history will be displayed here -->
<p>No travel history yet. Start planning your next trip!</p>
</div>
</div>
</div>

<footer>
  <div class="footer-container">

    <!-- å·¦ä¾§ -->
    <div class="footer-left">
      <h2>Travel Recommender</h2>
      <p class="tagline">Trust us, safe and secure.</p>
    </div>

    <!-- ä¸­é—´åˆ†éš”çº¿ -->
    <div class="footer-divider"></div>

    <!-- å³ä¾§ -->
    <div class="footer-right">
      <div class="contact-info">
        <p><strong>ğŸ“ Phone:</strong> +1 (555) 123-4567</p>
        <p><strong>âœ‰ï¸ Email:</strong> info@travelrecommender.com</p>
      </div>

      <div class="footer-social">
        <a href="#" title="Instagram">ğŸ“·</a>
        <a href="#" title="Facebook">ğŸ‘</a>
        <a href="#" title="WeChat">ğŸ’¬</a>
      </div>
    </div>

  </div>

  <p class="footer-bottom">&copy; 2025 Travel Recommendation System. All rights reserved.</p>
</footer>


<script>
  // å¯¼èˆªæ»šåŠ¨å˜è‰²ï¼šæ·»åŠ /ç§»é™¤ header.scrolled
(function(){
  const header = document.querySelector('header');
  if(!header) return;
  function onScroll(){
    if(window.scrollY > 60) header.classList.add('scrolled');
    else header.classList.remove('scrolled');
  }
  window.addEventListener('scroll', onScroll, {passive:true});
  onScroll();
})();

// Display username
const username = localStorage.getItem('username');
document.getElementById('displayUsername').textContent = username || 'Guest';

// My Trip æŒ‰é’®åŠŸèƒ½
document.getElementById('mytripBtn').addEventListener('click', function() {
    window.location.href = 'mytrip.html';
});

//likedæŒ‰é’®åŠŸèƒ½
document.getElementById('likedBtn').addEventListener('click', function () {
  window.location.href = 'liked.html';
});

// Logout functionality
document.getElementById('logoutBtn').addEventListener('click', function() {
localStorage.removeItem('username');
localStorage.removeItem('phone');
window.location.href = 'index.html';
});

// History button functionality
const historyBtn = document.getElementById('historyBtn');
const historyModal = document.getElementById('historyModal');
const closeHistoryModalBtn = document.getElementById('closeHistoryModalBtn');

historyBtn.addEventListener('click', function() {
historyModal.style.display = 'flex';
});

closeHistoryModalBtn.addEventListener('click', function() {
historyModal.style.display = 'none';
});

// Destination data with attractions
const destinations = [
// å¤–å›½åœ°ç‚¹
{
id: 1,
name: 'Paris',//å·´é»
image: 'https://images.unsplash.com/photo-1431274172761-fca41d930114?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'The city of love and lights',
details: 'Paris is the capital of France, known for its art, fashion, gastronomy and culture. The 19th-century cityscape is crisscrossed by wide boulevards and the River Seine. Major landmarks include the Eiffel Tower, Notre-Dame Cathedral and the Louvre Museum.',
attractions: [
{
name: 'Eiffel Tower',
image: 'https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'Iconic iron tower offering city views and dining options'
},
{
name: 'Louvre Museum',
image: 'https://images.unsplash.com/photo-1444418776041-9c7e33cc5a9c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'World\'s largest art museum and historic monument'
},
{
name: 'Notre-Dame Cathedral',
image: 'https://img95.699pic.com/photo/50123/5271.jpg_wh860.jpg',
description: 'Medieval Catholic cathedral with Gothic architecture'
},
{
name: 'Champs-Ã‰lysÃ©es',
image: 'https://www.egali.com.br/wp-content/uploads/2019/12/flynn-zhou-NVGqJvdyQLs-unsplash-1.jpg',
description: 'A world-famous avenue known for its theaters, cafÃ©s, and luxury shops.'
},
{
name: 'Palace of Versailles',
image: 'https://pic.yupoo.com/fotomag/ad6b2527/843e3d71.jpg',
description: 'A grand palace and former royal residence, renowned for its gardens and Hall of Mirrors.'
}
]
},
{
id: 2,
name: 'Tokyo',//ä¸œäº¬
image: 'https://images.unsplash.com/photo-1492571350019-22de08371fd3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'Vibrant metropolis blending tradition and modernity',
details: 'Tokyo, Japan\'s busy capital, mixes the ultramodern and the traditional, from neon-lit skyscrapers to historic temples. Must-visit spots include the Meiji Shinto Shrine, the Imperial Palace and the bustling Shibuya Crossing.',
attractions: [
{
name: 'Shibuya Crossing',
image: 'https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'World\'s busiest pedestrian crossing with neon lights'
},
{
name: 'Meiji Shrine',
image: 'https://images.unsplash.com/photo-1526481280693-3bfa7568e0f3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'Tranquil Shinto shrine surrounded by forest'
},
{
name: 'Tokyo Tower',
image: 'https://images.unsplash.com/photo-1513407030348-c983a97b98d8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'Eiffel Tower-inspired landmark with observation decks'
},
{
name: 'Senso-ji Temple',
image: 'https://tmyun.com/jpeg/yun_17964.jpg',
description: 'Tokyoâ€™s oldest temple, located in the historic Asakusa district.'
},
{
name: 'Tokyo Skytree',
image: 'https://s1.kkday.com/images/product/10759/20170116074826_VMRPO.jpg',
description: 'The tallest structure in Japan with observation decks and a shopping complex.'
}
]
},
{
id: 3,
name: 'Rome',//ç½—é©¬
image: 'https://images.unsplash.com/photo-1529260830199-42c24126f198?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'Eternal city with ancient history',
details: 'Rome is the capital of Italy and was once the center of the ancient Roman Empire. Must-see attractions include the Colosseum, Roman Forum, Pantheon and Vatican City, home to St. Peter\'s Basilica and the Vatican Museums.',
attractions: [
{
name: 'Colosseum',
image: 'https://images.unsplash.com/photo-1552832230-c0197dd311b5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
description: 'Ancient amphitheater that held gladiator contests'
},
{
name: 'Trevi Fountain',
image: 'https://youimg1.c-ctrip.com/target/1006160000010gnh156CC.jpg',
description: 'Baroque fountain where visitors toss coins'
},
{
name: 'Pantheon',
image: 'https://youimg1.c-ctrip.com/target/100d0y000000mai8r2FF0.jpg',
description: 'Ancient Roman temple with a domed roof'
},
{
name: 'St. Peterâ€™s Basilica',
image: 'https://img1.qunarzz.com/travel/d4/1805/27/3da46a32449c2bb5.jpg',
description: 'A Renaissance-era basilica in Vatican City, home to iconic art and architecture.'
},
{
name: 'Roman Forum',
image: 'https://youimg1.c-ctrip.com/target/100m1c000001dol2jC1EC.jpg',
description: 'Ruins of ancient government buildings at the heart of ancient Rome.'
}
]
},
// ä¸­å›½åœ°ç‚¹

  {
    id: 4,
    name: 'Beijing',//åŒ—äº¬
    image: 'https://images.unsplash.com/photo-1547981609-4b6bfe67ca0b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
    description: 'The capital of China, rich in historical and cultural heritage.',
    details: 'Beijing is a historic and cultural city in China, home to famous sites like the Forbidden City, the Great Wall, and the Temple of Heaven. It is also a modern international metropolis.',
    attractions: [
      {
        name: 'Forbidden City',
        image: 'https://www.beijing.gov.cn/renwen/rwzyd/bwg/ggbwy/202301/W020230302518258830828.jpg',
        description: 'Ancient imperial palace complex, a UNESCO World Heritage Site.'
      },
      {
        name: 'Great Wall',
        image: 'https://images.chinahighlights.com/allpicture/2014/07/a75e71599fcc40d1b72fb2b8_cut_800x500_61.jpg',
        description: 'One of the New Seven Wonders of the World, ancient military defense project.'
      },
      {
        name: 'Temple of Heaven',
        image: 'https://images.unsplash.com/photo-1547981609-4b6bfe67ca0b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
        description: 'Site of imperial ceremonies for worship and harvest prayers during Ming and Qing dynasties.'
      },
      {
        name: 'Summer Palace',
        image: 'https://www.bijingdi.com/uploadfile/2021/1127/20211127195738699.jpg',
        description: 'Chinese imperial garden during the Qing Dynasty.'
      },
      {
        name: 'National Museum of China',
        image: 'https://youimg1.c-ctrip.com/target/10051f000001gsu0v03DD_D_10000_1200.jpg?proc=autoorient',
        description: 'The National Museum of China has a history of more than 100 years, with a building area of â€‹â€‹nearly 200,000 square meters and more than 1.4 million collections..'
      }
    ]
  },
  {
    id: 5,
    name: 'Shanghai',//ä¸Šæµ·
    image: 'https://pic.616pic.com/bg_w1180/00/06/51/KI1O6vvnbQ.jpg!/fw/1120',
    description: 'The most international city in China.',
    details: 'Shanghai is Chinaâ€™s center for economy, finance, trade, and shipping. Landmarks like the Bund and Oriental Pearl Tower show its blend of Eastern and Western cultures.',
    attractions: [
      {
        name: 'The Bund',
        image: 'https://youimg1.c-ctrip.com/target/tg/056/322/802/e6d37f503b5c462d929e84659cffb134.jpg',
        description: 'Historical waterfront buildings by the Huangpu River, iconic Shanghai view.'
      },
      {
        name: 'Oriental Pearl Tower',
        image: 'https://www.brandinginasia.com/wp-content/uploads/2020/08/Shanghai-Branding-in-Asia.jpg',
        description: 'Famous TV tower offering panoramic views of the city.'
      },
      {
        name: 'Shanghai Disneyland',
        image: 'https://youimg1.c-ctrip.com/target/10051f000001gsqk8D0BC_D_10000_1200.jpg?proc=autoorient',
        description: 'A fantasy world full of joy and surprises.'
      },
      {
      name: 'Yu Garden',
      image: 'https://www.asiaodysseytravel.com/images/china-tours/group-tours/yu-garden-700-2.jpg',
      description: 'A classical Chinese garden with pavilions, rockeries, and ponds.'
    },
    {
      name: 'Nanjing Road',
      image: 'https://pic1.k1u.com/k1u/mb/d/file/20200529/1590747196668672_836_10000.jpg',
      description: 'A major shopping street known for its bright lights and vibrant atmosphere.'
    }
    ]
  },
  {
    id: 6,
    name: 'Xiâ€™an',//è¥¿å®‰
    image: 'https://img1.qunarzz.com/travel/poi/1806/1e/e39e64be5446d537.jpg?ver=1',
    description: 'A historic and cultural city of China.',
    details: 'Xiâ€™an is the starting point of the Silk Road and one of Chinaâ€™s Four Great Ancient Capitals. It features many historical sites like the Terracotta Army and Giant Wild Goose Pagoda.',
    attractions: [
      {
        name: 'Terracotta Army',
        image: 'https://ma7media.storage.googleapis.com/sites/default/files/styles/freeform_large_9_2x/s3/migrated/pictures/archiv_agy/2015/201505040925120.002.jpg?itok=aomAkGyM',
        description: 'Burial pits of Emperor Qin Shi Huang, known as the Eighth Wonder of the World.'
      },
      {
        name: 'Giant Wild Goose Pagoda',
        image: 'https://www.chinatoursnet.com/uploads/main/litimg/2019-05-27/5ceb3d0638884.jpg',
        description: 'Tang Dynasty Buddhist pagoda where monk Xuanzang translated scriptures.'
      },
      {
        name: 'Datang Everbright City',
        image: 'https://n.sinaimg.cn/sinakd20210222ac/725/w2000h1125/20210222/0b8c-kkmphps1384742.jpg',
        description: 'With the prosperous Tang Dynasty culture as its background, it integrates cultural display, sightseeing, leisure and entertainment, shopping and dining. It is a landmark attraction and cultural business card of Xian.'
      },
      {
      name: 'Ancient City Wall',
      image: 'https://pic.52112.com/180702/JPG-180702_364/pt0zgIza7J_small.jpg',
      description: 'A well-preserved fortification surrounding the old city of Xiâ€™an.'
    },
{
      name: 'Bell Tower of Xiâ€™an',
      image: 'https://youimg1.c-ctrip.com/target/100c0d0000006tbbg5863.jpg',
      description: 'A symbol of Xiâ€™an, located at the cityâ€™s center.'
    }
    ]
  },
  {
    id: 7,
    name: 'Kuala Lumpur',//å‰éš†å¡
    image: 'https://vincentloy.wordpress.com/wp-content/uploads/2017/07/35760010171_ef3509b067_h.jpg?w=584',
    description: 'The capital of Malaysia.',
    details: 'Kuala Lumpur is Malaysiaâ€™s capital, a modern city blending multicultural traditions, with landmarks like the Petronas Twin Towers.',
    attractions: [
      {
        name: 'Petronas Twin Towers',
        image: 'https://wallpaperaccess.com/full/6217300.jpg',
        description: 'Iconic skyscrapers, the tallest twin towers in the world.'
      },
      {
        name: 'Merdeka Square',
        image: 'https://dimg04.c-ctrip.com/images/02Y0e120009f1wvxxEA50_R_1080_808_Q90.jpg',
        description: 'Historic site marking Malaysiaâ€™s independence.'
      },
      {
        name: 'Petaling Street',
        image: 'https://tr-osdcp.qunarzz.com/tr-osd-tr-space/img/9b1c8952d39b6345fb7e2a61c72979a5.jpg_480x360x95_8ca79e8f.jpg',
        description: 'Kuala Lumpurâ€™s Chinatown, known for shopping and street food.'
      },
      {
      name: 'Batu Caves',
      image: 'https://n.sinaimg.cn/sinacn20123/213/w2048h1365/20190315/5487-hufnxfn9661372.jpg',
      description: 'A limestone hill with a series of caves and Hindu shrines.'
    },
   
    {
      name: 'Bukit Bintang',
      image: 'https://i.ytimg.com/vi/EyZ4d_GmQ6g/maxresdefault.jpg',
      description: 'A lively shopping and entertainment district in central Kuala Lumpur.'
    }
    ]
  },
  {
    id: 8,
    name: 'Penang',//æ§ŸåŸ
    image: 'https://img1.qunarzz.com/travel/d9/1701/77/02d9a4cc890844b5.jpg_r_1360x1360x95_de462271.jpg',
    description: 'Malaysiaâ€™s food paradise.',
    details: 'Penang is famous for its cuisine and cultural heritage. George Townâ€™s street art and multicultural architecture attract visitors from around the world.',
    attractions: [
      {
        name: 'George Town Murals',
        image: 'https://youimg1.c-ctrip.com/target/tg/107/550/624/7cc37cf6936246e1ad5c130befc84844.jpg',
        description: 'Iconic street art, perfect for photo spots.'
      },
      {
        name: 'Penang Hill',
        image: 'https://tr-osdcp.qunarzz.com/tr-osd-tr-space/img/911209c1ffda17db8f2fe0397f049b08.jpg_480x360x95_c99ce9bb.jpg',
        description: 'Highest point in Penang, offering panoramic city views.'
      },
      {
        name: 'Kek Lok Si Temple',
        image: 'https://media.istockphoto.com/id/1987296367/zh/%E7%85%A7%E7%89%87/kek-lok-si-temple-in-george-town.jpg?s=1024x1024&w=is&k=20&c=91w-WC2qnkD97KQl3VgUJBADhl6YupYvcDEIsJmI9_E=',
        description: 'One of the most important Buddhist temples in Malaysia.'
      },
      {
      name: 'Penang Peranakan Mansion',
      image: 'https://thesmartlocal.my/wp-content/uploads/2022/09/image16-5-667x500.jpg',
      description: 'A heritage mansion showcasing Peranakan culture and antiques.'
    },
    {
      name: 'Gurney Drive',
      image: 'https://www.anjnaglobal.com/img/Malaysia-Attraction-Tours/banner/Gurney-Drive.png',
      description: 'A popular seafront promenade known for hawker food and shopping.'
    }
    ]
  },
  {
    id: 9,
    name: 'Langkawi',//å…°å¡å¨
    image: 'https://img1.qunarzz.com/travel/d8/1703/9b/a4ace83b30185b5.jpg_r_1360x1360x95_ae5e9df3.jpg',
    description: 'Malaysiaâ€™s resort paradise.',
    details: 'Langkawi is famous for its beaches, duty-free shopping, and natural sceneryâ€”an ideal destination for relaxation.',
    attractions: [
      {
        name: 'Sky Bridge',
        image: 'https://img.freepik.com/photos-gratuite/structure-metallique-entre-montagnes_1122-2204.jpg?w=996&t=st=1697330142~exp=1697330742~hmac=9ca8e3ba51eb0e2db239d94364a4a5b832505ee8fcf6e7c84e7fdec38421075b',
        description: 'Suspended steel bridge offering thrilling mountain views.'
      },
      {
        name: 'Pantai Cenang',
        image: 'https://cdn.pixabay.com/photo/2016/09/07/06/23/beach-1650889_1280.jpg',
        description: 'Popular beach with white sands and clear water.'
      },
      {
        name: 'Mangrove Forest',
        image: 'https://langkawi-travel-6868.com/wp-content/uploads/2019/03/Langkawi-Eagle-Watching-02.jpg',
        description: 'Unique ecosystem with boat tours available.'
      },
      {
      name: 'Eagle Square',
      image: 'https://img1.qunarzz.com/travel/d8/1703/7b/7e7843e1564c65b5.jpg_r_640x426x70_4709b834.jpg',
      description: 'A prominent landmark featuring a giant eagle statue near the waterfront.'
    },
    {
      name: 'Telaga Tujuh Waterfalls',
      image: 'https://img1.qunarzz.com/piao/fusion/1611/66/45a926c00de45002.jpg',
      description: 'The scenery around Qixianjing is full of green forests, and you can enjoy the whole mountain scenery.'
    }
    ]
  }
];


        /// Generate destination cards
       const destinationsGrid = document.getElementById('destinationsGrid');

         destinations.forEach(destination => {
         const card = document.createElement('div'); 
         card.className = 'destination-card';
         card.innerHTML = `
               <div class="destination-img" style="background-image: url(${destination.image})"></div>
               <div class="destination-overlay"> View Attractions â†’   </div>
               <div class="destination-info">
              <div class="destination-name">${destination.name}</div>
            <div class="destination-desc">${destination.description}</div>
         </div>
          `;

      card.addEventListener('click', () => showDestinationModal(destination));
      destinationsGrid.appendChild(card);
    
    // ä¿®æ”¹ç‚¹å‡»äº‹ä»¶ï¼Œç›´æ¥è·³è½¬åˆ°åŸå¸‚è¯¦æƒ…é¡µ
    card.addEventListener('click', () => window.location.href = `city.html?id=${destination.id}`);
    destinationsGrid.appendChild(card);
});

// ä¿ç•™æ¨¡æ€æ¡†åŠŸèƒ½ï¼Œä½†æ·»åŠ è·³è½¬æŒ‰é’®
function showDestinationModal(destination) {
    let attractionsHtml = '';
    destination.attractions.forEach(attraction => {
        attractionsHtml += `
            <div class="attraction-card">
                <div class="attraction-img" style="background-image: url(${attraction.image})"></div>
                <div class="attraction-info">
                    <div class="attraction-name">${attraction.name}</div>
                    <div class="attraction-desc">${attraction.description}</div>
                </div>
            </div>
        `;
    });

    destinationDetails.innerHTML = `
        <img src="${destination.image}" alt="${destination.name}">
        <h3>${destination.name}</h3>
        <p>${destination.details}</p>
        <h4 style="margin: 20px 0 10px; color: #1e90ff;">Top Attractions</h4>
        <div class="attractions-grid">
            ${attractionsHtml}
        </div>
        <div style="margin-top: 20px; display: flex; gap: 10px;">
          <button class="rec-btn" onclick="
  addToPlan({
    id: '${destination.id}',
    name: '${destination.name}',
    city: '${destination.name}',
    lat: 0,
    lng: 0,
    image: '${destination.image}',
    durationMinutes: 90
  })
">Add to Plan</button>


<button class="rec-btn" onclick="
  addToPlan({
    id: '${destination.id}',
    name: '${destination.name}',
    city: '${destination.name}',
    lat: 0,
    lng: 0,
    image: '${destination.image}',
    durationMinutes: 90
  })
">Add to Plan</button>

        </div>
    `;

    destinationModal.style.display = 'flex';
}


        // Destination dropdown functionality
        const destinationInput = document.getElementById('destination');
        const dropdownArrow = document.getElementById('dropdownArrow');
        const destinationList = document.getElementById('destinationList');

      

   // Only bind if dropdownArrow exists
if (dropdownArrow) {
  dropdownArrow.addEventListener('click', function(e) {
    // stop propagation to avoid immediately hitting the document click handler
    e.stopPropagation();
    if (destinationList && destinationList.style.display === 'block') {
      destinationList.style.display = 'none';
    } else if (destinationList) {
      destinationList.style.display = 'block';
    }
  });
} else {
  // Optional: log so we know element is missing during development
  //console.warn('dropdownArrow element not found â€” dropdown toggle disabled.');
}

// Close dropdown when clicking outside (use optional chaining to avoid null errors)
document.addEventListener('click', function(e) {
  const clickedOutsideInput = destinationInput ? !destinationInput.contains(e.target) : true;
  const clickedOutsideList = destinationList ? !destinationList.contains(e.target) : true;
  const clickedOutsideArrow = dropdownArrow ? !dropdownArrow.contains(e.target) : true;

  if (clickedOutsideInput && clickedOutsideList && clickedOutsideArrow) {
    if (destinationList) destinationList.style.display = 'none';
  }
});

        // Show destination modal
        const destinationModal = document.getElementById('destinationModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const destinationDetails = document.getElementById('destinationDetails');

        function showDestinationModal(destination) {
            // Generate attractions HTML
            let attractionsHtml = '';
            destination.attractions.forEach(attraction => {
                attractionsHtml += `
                    <div class="attraction-card">
                        <div class="attraction-img" style="background-image: url(${attraction.image})"></div>
                        <div class="attraction-info">
                            <div class="attraction-name">${attraction.name}</div>
                            <div class="attraction-desc">${attraction.description}</div>
                        </div>
                    </div>
                `;
            });

            destinationDetails.innerHTML = `
                <img src="${destination.image}" alt="${destination.name}">
                <h3>${destination.name}</h3>
                <p>${destination.details}</p>
                <h4 style="margin: 20px 0 10px; color: #1e90ff;">Top Attractions</h4>
                <div class="attractions-grid">
                    ${attractionsHtml}
                </div>
                <button class="rec-btn" onclick="addToPlan('${destination.name}')" style="margin-top: 20px;">Add to Plan</button>
            `;
            destinationModal.style.display = 'flex';
        }

        closeModalBtn.addEventListener('click', () => {
            destinationModal.style.display = 'none';
        });

        window.addToPlan = function(destinationName) {
            document.getElementById('destination').value = destinationName;
            destinationModal.style.display = 'none';
        };

        // Form submission
        const travelForm = document.getElementById('travelForm');
        const recommendationsSection = document.getElementById('recommendationsSection');
        const recommendationsList = document.getElementById('recommendationsList');

      
          
        
        // Generate mock recommendations
        function generateRecommendations(destination, people, days, budget) {
            const budgets = {
                low: { min: 30, max: 50 },
                medium: { min: 50, max: 100 },
                high: { min: 100, max: 300 }
            };
            
            const range = budgets[budget];
            const pricePerDay = Math.floor(Math.random() * (range.max - range.min + 1)) + range.min;
            const totalPrice = pricePerDay * days * people;
            
            const images = [
                'https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
                'https://images.unsplash.com/photo-1503917988258-f87a78e3c995?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
                'https://images.unsplash.com/photo-1506197603052-3cc9c3a201bd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
                'https://images.unsplash.com/photo-1506929562872-bb421503ef21?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80',
                'https://images.unsplash.com/photo-1508672019048-805c876b67e2?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80'
            ];
            
            const types = [
                'Free & Easy Package',
                'Group Tour',
                'Premium Small Group',
                'Private Customized',
                'Cultural Experience'
            ];
            
            const recs = [];
            
            for (let i = 0; i < 3; i++) {
                const typeIndex = Math.floor(Math.random() * types.length);
                const imageIndex = Math.floor(Math.random() * images.length);
                
                recs.push({
                    title: `${destination} ${types[typeIndex]} (${days} days, ${people} people)`,
                    details: `Includes ${days-1} nights accommodation, attraction tickets, ${i+1} special meals, local guide service`,
                    price: `Total: $${totalPrice + (i*100)}`,
                    image: images[imageIndex]
                });
            }
            
            return recs;
        }

        
  // -------- Travel history: save (improved, dedupe & unified structure) --------
function addToHistory(destination, people, days, budget, opts = {}) {
  try {
    const nowDate = new Date().toLocaleDateString();
    const hist = JSON.parse(localStorage.getItem('travelHistory') || '[]');

    const simpleRoute = opts.simpleRoute || destination || "Trip";

    const newRecord = {
      tripId: Date.now(),
      simpleRoute: simpleRoute,
      date: nowDate,
      summary: {
        daysCount: Number(days) || 1,
        totalDistance: (opts.totalDistance !== undefined) ? String(opts.totalDistance) : "0.00",
        transport: opts.transport || "driving-car"
      },
      meta: {
        people: people || 1,
        budget: budget || ''
      }
    };

    // å»é‡ï¼šç§»é™¤å·²æœ‰ç›¸åŒ simpleRoute & ç›¸åŒ date çš„è®°å½•ï¼ˆé¿å…é‡å¤ï¼‰
    const deduped = hist.filter(h => !(h.simpleRoute === newRecord.simpleRoute && h.date === newRecord.date));

    // å°†æ–°çºªå½•æ”¾åˆ°æœ€å‰é¢
    deduped.unshift(newRecord);

    // å†™å›
    localStorage.setItem('travelHistory', JSON.stringify(deduped));
    console.log('âœ… addToHistory saved:', newRecord);
  } catch (e) {
    console.error('âŒ addToHistory failed', e);
  }
}

// -------- Travel history: load & render (with Delete button) --------
function loadHistory() {
  const history = JSON.parse(localStorage.getItem('travelHistory') || '[]');
  const historyList = document.getElementById('historyList');

  if (!historyList) {
    console.warn('historyList element not found');
    return;
  }

  if (!history.length) {
    historyList.innerHTML = '<p>No travel history yet. Start planning your next trip!</p>';
    return;
  }

  // æ„å»º HTMLï¼ˆä¸ºæ¯æ¡è®°å½•æ·»åŠ  data-id å’Œåˆ é™¤æŒ‰é’®ï¼‰
  let html = '';
  history.forEach(trip => {
    const title = trip.simpleRoute || trip.destination || 'Trip';
    const date = trip.date || 'â€”';
    const days = (trip.summary && trip.summary.daysCount) ? trip.summary.daysCount : (trip.days || 'â€”');
    const transport = (trip.summary && trip.summary.transport) ? trip.summary.transport : (trip.transport || 'â€”');
    const totalDistance = (trip.summary && trip.summary.totalDistance) ? trip.summary.totalDistance : (trip.totalDistance || 'â€”');

    html += `
      <div class="rec-card" style="margin-bottom: 12px;" data-id="${trip.tripId}">
        <div class="rec-content">
          <div style="display:flex; justify-content:space-between; align-items:flex-start;">
            <div class="rec-title" style="flex:1; margin-right:10px;">${escapeHtml(title)}</div>
            <div style="flex-shrink:0;">
              <button class="del-history" data-id="${trip.tripId}" style="background:#ff6b6b;border:none;color:#fff;padding:6px 10px;border-radius:8px;cursor:pointer;">Delete</button>
            </div>
          </div>
          <div class="rec-details" style="margin-top:8px;">
            <p style="margin:4px 0;">Date: ${escapeHtml(date)}</p>
            <p style="margin:4px 0;">Days: ${escapeHtml(String(days))}</p>
            <p style="margin:4px 0;">Transport: ${escapeHtml(transport)}</p>
            <p style="margin:4px 0;">Total Distance: ${escapeHtml(String(totalDistance))} km</p>
          </div>
        </div>
      </div>
    `;
  });

  historyList.innerHTML = html;

  // ä¸ºæ¯ä¸ª Delete æŒ‰é’®ç»‘å®šäº‹ä»¶
  const delBtns = historyList.querySelectorAll('.del-history');
  delBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const id = e.currentTarget.getAttribute('data-id');
      if (!id) return;
      if (!confirm('Delete this history record?')) return;

      const cur = JSON.parse(localStorage.getItem('travelHistory') || '[]');
      const filtered = cur.filter(r => String(r.tripId) !== String(id));
      localStorage.setItem('travelHistory', JSON.stringify(filtered));

      // é‡æ–°æ¸²æŸ“
      loadHistory();
    });
  });
}

// ç®€å•çš„ HTML è½¬ä¹‰
function escapeHtml(str) {
  return String(str || '').replace(/[&<>"']/g, function(m) {
    return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]);
  });



}

  // ---------- Attach handlers safely ----------
  document.addEventListener('DOMContentLoaded', function () {
    const historyBtn = document.getElementById('historyBtn');
const historyModal = document.getElementById('historyModal');
const closeHistoryModalBtn = document.getElementById('closeHistoryModalBtn');

// ---------- å®‰å…¨å¡«å…… destinationListï¼ˆåªä¿ç•™è¿™æ®µï¼‰ ----------
(function fillDestinationListOnce(){
  // å…ˆé€šè¿‡å·²å­˜åœ¨çš„å…¨å±€ destinationsï¼ˆå¦‚æœä½ åœ¨æ–‡ä»¶é¡¶éƒ¨å®šä¹‰äº†ï¼‰ï¼Œå¦åˆ™ä» window.destinations è¯»å–
  const data = (window.destinations && window.destinations.length) ? window.destinations : (typeof destinations !== 'undefined' ? destinations : []);

  // ç¡®ä¿ destinationList å­˜åœ¨ï¼ˆé¿å… nullï¼‰
  let destinationList = document.getElementById('destinationList');
  if (!destinationList) {
    destinationList = document.createElement('div');
    destinationList.id = 'destinationList';
    destinationList.style.display = 'none';
    document.body.appendChild(destinationList);
  }

  // æ¸…ç©ºæ—§å†…å®¹ï¼ˆé˜²æ­¢é‡å¤ appendï¼‰
  destinationList.innerHTML = '';

  // å¡«å……
  data.forEach(dest => {
    const item = document.createElement('div');
    item.className = 'destination-item';
    item.textContent = dest.name || '';
    item.addEventListener('click', () => {
      const destinationInput = document.getElementById('destination');
      if (destinationInput) destinationInput.value = dest.name || '';
      destinationList.style.display = 'none';
    });
    destinationList.appendChild(item);
  });
})();


if (historyBtn) {
  historyBtn.addEventListener('click', function() {
    // æ¯æ¬¡æ‰“å¼€æ¨¡æ€æ¡†å‰åˆ·æ–°å†å²æ•°æ®
    try { loadHistory(); } catch (e) { console.error('loadHistory() not defined or failed', e); }
    historyModal.style.display = 'flex';
  });
}

if (closeHistoryModalBtn) {
  closeHistoryModalBtn.addEventListener('click', function() {
    historyModal.style.display = 'none';
  });
}


  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // ----- å¦‚æœä½ å·²ç»åœ¨ main.html æœ‰ destinations æ•°æ®æ•°ç»„ï¼Œå¯ä»¥åˆ é™¤ä¸‹é¢è¿™ä¸€è¡Œçš„ç©ºæ•°ç»„å ä½å¹¶ä¿ç•™åŸæ¥çš„ destinations -----
    const destinations = [ 
      // å¦‚æœä½  main.html å·²ç»å®šä¹‰äº† destinationsï¼Œè¯·æŠŠè¿™è¡Œæ”¹ä¸ºï¼š const destinations = window.destinations || []; 
      // æˆ‘è¿™é‡Œæš‚ä¸å¡«å…·ä½“é¡¹ï¼Œå‡è®¾é¡µé¢å·²æœ‰ä¸€ä»½ destinations æ•°æ®
    ];
  
    // ç¡®ä¿ä¸‹æ‹‰å®¹å™¨å­˜åœ¨ï¼ˆé¿å… nullï¼‰
    if (!document.getElementById('destinationList')) {
      const dl = document.createElement('div');
      dl.id = 'destinationList';
      dl.style.display = 'none';
      document.body.appendChild(dl);
    }
  
    const destinationsGrid = document.getElementById('destinationsGrid');
  
    if (!destinationsGrid) {
      console.warn('destinationsGrid not found â€” skipping rendering destination cards');
    } else {
      // å¦‚æœé¡µé¢å·²ç»æœ‰ destinations å˜é‡ï¼ˆåœ¨ä½ çš„æ–‡ä»¶å¼€å¤´ï¼‰ï¼Œä½¿ç”¨å®ƒï¼›å¦åˆ™ä¸è¦è¦†ç›–
      const data = (window.destinations && window.destinations.length) ? window.destinations : destinations;
      (data || []).forEach(destination => {
        const card = document.createElement('div');
        card.className = 'destination-card';
        card.innerHTML = `
          <div class="destination-img" style="background-image: url(${destination.image || ''})"></div>
          <div class="destination-info">
            <div class="destination-name">${destination.name || ''}</div>
            <div class="destination-desc">${destination.description || ''}</div>
          </div>
        `;
  
        card.addEventListener('click', () => {
          if (typeof showDestinationModal === 'function') {
            showDestinationModal(destination);
          } else {
            // å¦‚æœæ²¡æœ‰ modal å‡½æ•°ï¼Œç›´æ¥è·³è½¬ï¼ˆå¯é€‰ï¼‰
            // window.location.href = `city.html?id=${destination.id}`;
          }
        });
  
        destinationsGrid.appendChild(card);
      });
    }
  
    // ç›®çš„åœ°ä¸‹æ‹‰åˆ—è¡¨ï¼ˆè‹¥éœ€ï¼‰
    const destinationInput = document.getElementById('destination');
    const destinationList = document.getElementById('destinationList');
    if (destinationList && destinationInput) {
      destinationList.innerHTML = '';
      const data = (window.destinations && window.destinations.length) ? window.destinations : destinations;
      (data || []).forEach(dest => {
        const item = document.createElement('div');
        item.className = 'destination-item';
        item.textContent = dest.name;
        item.addEventListener('click', () => {
          destinationInput.value = dest.name;
          destinationList.style.display = 'none';
        });
        destinationList.appendChild(item);
      });
    }
  
    // Modal å‡å¦‚é¡µé¢å·²æœ‰å…ƒç´ 
    const destinationModal = document.getElementById('destinationModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const destinationDetails = document.getElementById('destinationDetails');
  
    // å®‰å…¨è¦†å†™ showDestinationModalï¼ˆè‹¥é¡µé¢å·²æœ‰åŒåå‡½æ•°ï¼Œä¼šè¢«æ›¿æ¢ï¼‰
    window.showDestinationModal = function(destination) {
      if (!destinationDetails || !destinationModal) return;
      let attractionsHtml = '';
      (destination.attractions || []).forEach(attraction => {
        attractionsHtml += `
          <div class="attraction-card">
            <div class="attraction-img" style="background-image: url(${attraction.image || ''})"></div>
            <div class="attraction-info">
              <div class="attraction-name">${attraction.name || ''}</div>
              <div class="attraction-desc">${attraction.description || ''}</div>
            </div>
          </div>
        `;
      });
  
      destinationDetails.innerHTML = `
        <img src="${destination.image || ''}" alt="${destination.name || ''}" style="max-width:100%;border-radius:8px;"/>
        <h3>${destination.name || ''}</h3>
        <p>${destination.details || ''}</p>
        <h4 style="margin: 20px 0 10px; color: #1e90ff;">Top Attractions</h4>
        <div class="attractions-grid">${attractionsHtml}</div>
        <div style="margin-top: 20px; display:flex; gap:8px;">
          <button class="rec-btn" id="addToPlanBtn">Add to Plan</button>
        </div>
      `;
  
      const addBtn = document.getElementById('addToPlanBtn');
      if (addBtn) {
        addBtn.onclick = function() {
          if (window.Trip && typeof window.Trip.addToPlan === 'function') {
            window.Trip.addToPlan({
              id: destination.id,
              name: destination.name,
              city: destination.name,
              lat: destination.lat || 0,
              lng: destination.lng || 0,
              image: destination.image || '',
              durationMinutes: destination.durationMinutes || 90
            });
          } else {
            let arr = JSON.parse(localStorage.getItem('myTrip') || '[]');
            arr.push({
              id: destination.id,
              name: destination.name,
              city: destination.name,
              lat: destination.lat || 0,
              lng: destination.lng || 0,
              image: destination.image || '',
              durationMinutes: destination.durationMinutes || 90
            });
            localStorage.setItem('myTrip', JSON.stringify(arr));
            alert('Added to My Trip (fallback)');
          }
          destinationModal.style.display = 'none';
        };
      }
  
      destinationModal.style.display = 'flex';
    };
  
    if (closeModalBtn && destinationModal) {
      closeModalBtn.addEventListener('click', () => destinationModal.style.display = 'none');
    }
  
    // ---------- History handling ----------
    const historyBtn = document.getElementById('historyBtn');
    const historyModal = document.getElementById('historyModal');
    const closeHistoryModalBtn = document.getElementById('closeHistoryModalBtn');
  
  
    if (closeHistoryModalBtn && historyModal) {
      closeHistoryModalBtn.addEventListener('click', function() {
        historyModal.style.display = 'none';
      });
    }
  
  }); // end DOMContentLoaded
  </script>
  
<!-- æ–°å¢ç‹¬ç«‹çš„è„šæœ¬æ ‡ç­¾ï¼Œç¡®ä¿ä»£ç ä¼˜å…ˆçº§æœ€é«˜ -->
<script>
  // ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½åå†æ‰§è¡Œï¼ˆé¿å…å…ƒç´ è¿˜æ²¡æ¸²æŸ“å°±ç»‘å®šäº‹ä»¶ï¼‰
  document.addEventListener('DOMContentLoaded', function() {
      const travelForm = document.getElementById('travelForm');
      if (!travelForm) return; // ç¡®ä¿è¡¨å•å­˜åœ¨ï¼Œé˜²æ­¢æŠ¥é”™
  
      travelForm.addEventListener('submit', function(e) {
          // å¼ºåˆ¶é˜»æ­¢æ‰€æœ‰é»˜è®¤è¡Œä¸ºå’Œå†’æ³¡
          e.preventDefault();
          e.stopImmediatePropagation();
  
          // è·å–è¡¨å•å€¼ï¼ˆç¡®ä¿å…ƒç´ IDå’Œä½ çš„HTMLä¸€è‡´ï¼‰
          const destination = document.getElementById('destination')?.value;
          const days = document.getElementById('days')?.value;
          const budget = document.getElementById('budget')?.value;
          const people = document.getElementById('people')?.value;
  
          // éªŒè¯å¿…å¡«é¡¹
          if (!destination) { alert('Please select a destination!'); return; }
          if (!days) { alert('Please select days!'); return; }
          if (!budget) { alert('Please select budget!'); return; }
  
          // åŒ¹é…ç›®æ ‡æ¡ä»¶
          let targetBudget = '';
          if (days === '1' && budget === 'medium') {
              targetBudget = 'budget';
          } else if (days === '2' && budget === 'high') {
              targetBudget = 'luxury';
          } else {
              alert('Only support:\n1-Day + Comfort($50-$100) OR 2-Day + Luxury($100+)');
              return;
          }
  
          // æ‹¼æ¥è·³è½¬URLï¼ˆç¡®ä¿è·¯å¾„æ­£ç¡®ï¼‰
          const jumpUrl = `travel-plan.html?dest=${encodeURIComponent(destination)}&days=${days}&budget=${targetBudget}`;
          
          // å¼ºåˆ¶è·³è½¬ï¼ˆç”¨replaceé¿å…è¡¨å•é‡å¤æäº¤ï¼‰
          window.location.replace(jumpUrl);
  
          // æ‰§è¡Œå†å²è®°å½•ï¼ˆå¦‚æœå‡½æ•°å­˜åœ¨ï¼‰
          if (window.addToHistory) {
              addToHistory(destination, people, days, budget);
          }
      });
  });
  </script>
  
<script src="scripts/tripEngine.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const cards = document.querySelectorAll('.destination-card');
  
    const observer = new IntersectionObserver(
      function (entries, observer) {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('show');
            observer.unobserve(entry.target);
          }
        });
      },
      {
        threshold: 0.2
      }
    );
  
    cards.forEach(card => observer.observe(card));
  });
  </script>
  
</body>
</html>

